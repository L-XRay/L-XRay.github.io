<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HashMapæºç (ä¸Š)</title>
      <link href="/posts/235dfb88.html"/>
      <url>/posts/235dfb88.html</url>
      
        <content type="html"><![CDATA[<p>HashMap æœ€æ—©å‡ºç°åœ¨JDK1.2ä¸­ï¼Œåº•å±‚åŸºäºæ•£åˆ—ç®—æ³•å®ç°</p><ul><li>HashMap <strong>å…è®¸null é”®å’Œnull å€¼</strong>ï¼Œåœ¨è®¡ç®—å“ˆé”®çš„å“ˆå¸Œå€¼æ—¶ï¼Œ<strong>null é”®å“ˆå¸Œå€¼ä¸º0</strong>ã€‚</li><li>HashMap <strong>å¹¶ä¸ä¿è¯é”®å€¼å¯¹çš„é¡ºåº</strong>ï¼Œè¿™æ„å‘³ç€åœ¨è¿›è¡ŒæŸäº›æ“ä½œåï¼Œé”®å€¼å¯¹çš„é¡ºåºå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚</li><li>HashMap æ˜¯<strong>éçº¿ç¨‹å®‰å…¨ç±»</strong>ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ã€‚</li></ul><p>HashMapåœ¨JDK 1.8ä¸­åŒ…æ‹¬ï¼›1ã€æ•£åˆ—è¡¨å®ç°ã€2ã€æ‰°åŠ¨å‡½æ•°ã€3ã€åˆå§‹åŒ–å®¹é‡ã€4ã€è´Ÿè½½å› å­ã€5ã€æ‰©å®¹å…ƒç´ æ‹†åˆ†ã€6ã€é“¾è¡¨æ ‘åŒ–ã€7ã€çº¢é»‘æ ‘ã€8ã€æ’å…¥ã€9ã€æŸ¥æ‰¾ã€10ã€åˆ é™¤ã€11ã€éå†ã€12ã€åˆ†æ®µé”ç­‰ç­‰<br>è¿™é‡Œæˆ‘ä»¬å…ˆæŠŠç›®å…‰æ”¾åœ¨å‰äº”é¡¹ä¸Šï¼Œä¹Ÿå°±æ˜¯å…³äºæ•°æ®ç»“æ„çš„ä½¿ç”¨ä¸Šã€‚</p><h1 id="æ•£åˆ—è¡¨å®ç°ï¼ˆä¸€ä¸ªç®€å•çš„HashMapï¼‰"><a href="#æ•£åˆ—è¡¨å®ç°ï¼ˆä¸€ä¸ªç®€å•çš„HashMapï¼‰" class="headerlink" title="æ•£åˆ—è¡¨å®ç°ï¼ˆä¸€ä¸ªç®€å•çš„HashMapï¼‰"></a>æ•£åˆ—è¡¨å®ç°ï¼ˆä¸€ä¸ªç®€å•çš„HashMapï¼‰</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        list.add(<span class="string">&quot;one&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;power&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;technology&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;environment&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;world&quot;</span>);</span><br><span class="line"></span><br><span class="line">        String[] tab = <span class="keyword">new</span> <span class="title class_">String</span>[list.size()];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String value : list) &#123;</span><br><span class="line">            <span class="comment">// è®¡ç®—ç´¢å¼•: æŒ‡å®švalueçš„hashå€¼ æŒ‰ä½ä¸ tabæœ€å¤§ä¸‹æ ‡ ä¿è¯ä¸è¶Šç•Œ</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">key</span> <span class="operator">=</span> value.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">            System.out.println(String.format(<span class="string">&quot;key: %d, value: %s&quot;</span>,key,value));</span><br><span class="line">            <span class="comment">// å¦‚æœæ•°ç»„å½“å‰ç´¢å¼•ä¸­ä¸å­˜åœ¨value,èµ‹å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == tab[key]) &#123;</span><br><span class="line">                tab[key] = value;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å­˜åœ¨åˆ™å°†å…¶é“¾æ¥èµ·æ¥</span></span><br><span class="line">            tab[key] = tab[key]+ <span class="string">&quot;-&gt;&quot;</span>+ value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(Arrays.toString(tab));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/hashmap-simple.png" alt="hashmap-simple"></p><h3 id="æ‰€å­˜åœ¨çš„é—®é¢˜"><a href="#æ‰€å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="æ‰€å­˜åœ¨çš„é—®é¢˜"></a>æ‰€å­˜åœ¨çš„é—®é¢˜</h3><ol><li>æ‰€æœ‰çš„å…ƒç´ å­˜æ”¾éƒ½éœ€è¦ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼Œå¦‚æœç´¢å¼•ä½ç½®ä¸å¤Ÿå¯¼è‡´æ•£åˆ—ç¢°æ’ä¸¥é‡ï¼Œé‚£å°±æ²¡æœ‰è¾¾åˆ°é¢„æœŸçš„æ€§èƒ½ï¼Œä¹Ÿå°±å¤±å»äº†æ•£åˆ—è¡¨çš„æ„ä¹‰</li><li>åœ¨è·å–ç´¢å¼• ID çš„è®¡ç®—å…¬å¼ä¸­ï¼Œéœ€è¦æ•°ç»„é•¿åº¦æ˜¯ 2 çš„å€æ•°ï¼ˆéœ€è¦ä¿è¯èƒ½è¿›è¡ŒæŒ‰ä½ä¸æ“ä½œä¸è¶Šç•Œï¼‰ï¼Œæ•°ç»„å¤§å°å¦‚ä½•è®¾å®šï¼Ÿ</li><li>æ•°ç»„è¶Šå°ç¢°æ’è¶Šå¤§ï¼Œæ•°ç»„è¶Šå¤§ç¢°æ’è¶Šå°ï¼Œå¦‚ä½•å–èˆæ—¶é—´ä¸ç©ºé—´ï¼Ÿ</li><li>ç›®å‰å­˜æ”¾ 7 ä¸ªå…ƒç´ ï¼Œå·²ç»æœ‰ä¸¤ä¸ªä½ç½®éƒ½å­˜æ”¾äº† 2 ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆé“¾è¡¨è¶Šæ¥è¶Šé•¿æ€ä¹ˆä¼˜åŒ–ï¼Ÿ</li><li>éšç€å…ƒç´ çš„ä¸æ–­æ·»åŠ ï¼Œæ•°ç»„é•¿åº¦ä¸è¶³æ‰©å®¹æ—¶ï¼Œæ€ä¹ˆæŠŠåŸæœ‰çš„å…ƒç´ æ‹†åˆ†åˆ°æ–°çš„ä½ç½®ä¸Šå»ï¼Ÿ</li></ol><p>ä»¥ä¸Šè¿™äº›é—®é¢˜å¯ä»¥å½’çº³ä¸ºï¼›æ‰°åŠ¨å‡½æ•°ã€åˆå§‹åŒ–å®¹é‡ã€è´Ÿè½½å› å­ã€æ‰©å®¹æ–¹æ³•ä»¥åŠé“¾è¡¨å’Œçº¢é»‘æ ‘è½¬æ¢çš„ä½¿ç”¨ç­‰ã€‚</p><h1 id="æ‰°åŠ¨å‡½æ•°"><a href="#æ‰°åŠ¨å‡½æ•°" class="headerlink" title="æ‰°åŠ¨å‡½æ•°"></a>æ‰°åŠ¨å‡½æ•°</h1><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/hashmap-%E6%89%B0%E5%8A%A8%E5%87%BD%E6%95%B0.png" alt="hashmap-æ‰°åŠ¨å‡½æ•°"><br>åœ¨ HashMap å­˜æ”¾å…ƒç´ æ—¶å€™æœ‰è¿™æ ·ä¸€æ®µä»£ç æ¥å¤„ç†å“ˆå¸Œå€¼ï¼Œè¿™æ˜¯ Java 8 çš„æ•£åˆ—å€¼æ‰°åŠ¨å‡½æ•°ï¼Œç”¨äºä¼˜åŒ–æ•£åˆ—æ•ˆæœã€‚<br>ç†è®ºä¸Šæ¥è¯´å­—ç¬¦ä¸²çš„ hashCodeæ˜¯ä¸€ä¸ª int ç±»å‹å€¼ï¼Œé‚£å¯ä»¥ç›´æ¥ä½œä¸ºæ•°ç»„ä¸‹æ ‡äº†ï¼Œä¸”ä¸ä¼šå‡ºç°ç¢°æ’ã€‚ä½†æ˜¯è¿™ä¸ª hashCode çš„å–å€¼èŒƒå›´æ˜¯[-2147483648, 2147483647]ï¼Œ æœ‰å°†è¿‘ 40 äº¿çš„é•¿åº¦ï¼Œè°ä¹Ÿä¸èƒ½æŠŠæ•°ç»„åˆå§‹åŒ–çš„è¿™ä¹ˆå¤§ï¼Œå†…å­˜ä¹Ÿæ˜¯æ”¾ä¸ä¸‹çš„ã€‚ æˆ‘ä»¬<strong>é»˜è®¤åˆå§‹åŒ–çš„ Map å¤§å°æ˜¯ 16 ä¸ªé•¿åº¦ã€‚</strong>DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4ï¼Œ æ‰€ä»¥è·å–çš„ Hash å€¼å¹¶ä¸èƒ½ç›´æ¥ä½œä¸ºä¸‹æ ‡ä½¿ç”¨ï¼Œéœ€è¦ä¸æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡è¿ç®—å¾—åˆ°ä¸€ä¸ªä¸‹æ ‡å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢åšçš„æ•£åˆ—åˆ—å­ã€‚<br>hashMap æºç è¿™é‡Œä¸åªæ˜¯ç›´æ¥è·å–å“ˆå¸Œå€¼ï¼Œè¿˜è¿›è¡Œäº†ä¸€æ¬¡æ‰°åŠ¨è®¡ç®—ï¼Œ(h = key.hashCode()) ^ (h &gt;&gt;&gt; 16)ã€‚æŠŠå“ˆå¸Œå€¼å³ç§» 16 ä½ï¼Œä¹Ÿå°±æ­£å¥½æ˜¯è‡ªå·±é•¿åº¦çš„ä¸€åŠï¼Œä¹‹åä¸åŸå“ˆå¸Œå€¼åšå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·å°±æ··åˆäº†åŸå“ˆå¸Œå€¼ä¸­çš„é«˜ä½å’Œä½ä½ï¼Œå¢å¤§äº†<strong>éšæœºæ€§</strong>ã€‚<br><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/HashMap-%E6%89%B0%E5%8A%A8%E5%87%BD%E6%95%B0.drawio.png" alt="HashMap-æ‰°åŠ¨å‡½æ•°.drawio"><br>ä½¿ç”¨æ‰°åŠ¨å‡½æ•°å°±æ˜¯ä¸ºäº†å¢åŠ éšæœºæ€§ï¼Œè®©æ•°æ®å…ƒç´ æ›´åŠ å‡è¡¡çš„æ•£åˆ—ï¼Œå‡å°‘hashç¢°æ’ï¼Œè®©æ•°æ®å­˜æ”¾å’Œè·å–çš„æ•ˆç‡æ›´å¥½</p><h1 id="åˆå§‹åŒ–å®¹é‡"><a href="#åˆå§‹åŒ–å®¹é‡" class="headerlink" title="åˆå§‹åŒ–å®¹é‡"></a>åˆå§‹åŒ–å®¹é‡</h1><p>æ•£åˆ—æ•°ç»„éœ€è¦ä¸€ä¸ª 2 çš„å€æ•°çš„é•¿åº¦ï¼Œå› ä¸ºåªæœ‰ 2 çš„ å€æ•°åœ¨å‡ 1 çš„æ—¶å€™ï¼Œæ‰ä¼šå‡ºç° 01111 è¿™æ ·çš„å€¼ã€‚é‚£ä¹ˆè¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ– HashMap çš„æ—¶å€™ï¼Œå¦‚æœä¼ ä¸€ä¸ª 17 ä¸ªçš„å€¼ new HashMap&lt;&gt;(17);ï¼Œå®ƒä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><h2 id="å¯»æ‰¾æœ€å°äºŒè¿›åˆ¶æ•°"><a href="#å¯»æ‰¾æœ€å°äºŒè¿›åˆ¶æ•°" class="headerlink" title="å¯»æ‰¾æœ€å°äºŒè¿›åˆ¶æ•°"></a>å¯»æ‰¾æœ€å°äºŒè¿›åˆ¶æ•°</h2><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/hashmap-%E5%AF%BB%E6%89%BE%E6%9C%80%E5%B0%8F2%E7%9A%84n%E6%96%B9%E6%95%B0.png" alt="hashmap-å¯»æ‰¾æœ€å°2çš„næ–¹æ•°"></p><ul><li>åœ¨ HashMap çš„åˆå§‹åŒ–ä¸­ï¼Œé˜€å€¼ thresholdï¼Œé€šè¿‡æ–¹æ³• tableSizeFor è¿›è¡Œè®¡ç®—ï¼Œæ˜¯æ ¹æ®åˆå§‹åŒ–å¤§å°æ¥è®¡ç®—çš„ã€‚</li><li>è¿™ä¸ªæ–¹æ³•ä¹Ÿå°±æ˜¯è¦å¯»æ‰¾æ¯”åˆå§‹å€¼å¤§çš„ï¼Œæœ€å°çš„é‚£ä¸ª 2 è¿›åˆ¶æ•°å€¼ã€‚æ¯”å¦‚ä¼ äº† 17ï¼Œæˆ‘åº”è¯¥æ‰¾åˆ°çš„æ˜¯ 32ã€‚</li></ul><p>è®¡ç®—é˜€å€¼å¤§å°çš„æ–¹æ³•ï¼š<br><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/hashmap-tableSizeFor.png" alt="hashmap-tableSizeFor"></p><ul><li>MAXIMUM_CAPACITY = 1 &lt;&lt; 30ï¼Œè¿™ä¸ªæ˜¯ä¸´ç•ŒèŒƒå›´ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§å®¹é‡ã€‚</li><li>ä¹ä¸€çœ‹å¯èƒ½æœ‰ç‚¹æ™•ğŸ˜µæ€ä¹ˆéƒ½åœ¨å‘å³ç§»ä½ 1ã€2ã€4ã€8ã€16ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº† æŠŠäºŒè¿›åˆ¶çš„å„ä¸ªä½ç½®éƒ½å¡«ä¸Š 1ï¼Œå½“äºŒè¿›åˆ¶çš„å„ä¸ªä½ç½®éƒ½æ˜¯ 1 ä»¥åï¼Œå°±æ˜¯ ä¸€ä¸ªæ ‡å‡†çš„ 2 çš„å€æ•°å‡ 1 äº†ï¼Œæœ€åæŠŠç»“æœåŠ  1 å†è¿”å›å³å¯ã€‚</li></ul><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/HashMap-%E8%AE%A1%E7%AE%97%E9%98%88%E5%80%BC.drawio.png" alt="HashMap-è®¡ç®—é˜ˆå€¼.drawio"></p><h1 id="è´Ÿè½½å› å­"><a href="#è´Ÿè½½å› å­" class="headerlink" title="è´Ÿè½½å› å­"></a>è´Ÿè½½å› å­</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The default initial capacity - MUST be a power of two.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_INITIAL_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The maximum capacity, used if a higher value is implicitly specified</span></span><br><span class="line"><span class="comment">* by either of the constructors with arguments.</span></span><br><span class="line"><span class="comment">* MUST be a power of two &lt;= 1&lt;&lt;30.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAXIMUM_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The load factor used when none specified in constructor.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">DEFAULT_LOAD_FACTOR</span> <span class="operator">=</span> <span class="number">0.75f</span>;</span><br></pre></td></tr></table></figure><p>è´Ÿè½½å› å­ï¼Œå¯ä»¥ç†è§£æˆä¸€è¾†è½¦å¯æ‰¿é‡é‡é‡è¶…è¿‡æŸä¸ªé˜€å€¼æ—¶ï¼ŒæŠŠè´§æ”¾åˆ°æ–°çš„è½¦ä¸Šã€‚<br><strong>åœ¨ HashMap ä¸­ï¼Œè´Ÿè½½å› å­å†³å®šäº†æ•°æ®é‡å¤šå°‘äº†ä»¥åè¿›è¡Œæ‰©å®¹ã€‚</strong><br><em>è¿™é‡Œè¦æåˆ°ä¸Šé¢åšçš„ HashMap ä¾‹å­ï¼Œæˆ‘ä»¬å‡†å¤‡äº† 6 ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æœ€åè¿˜æœ‰ 2 ä¸ªä½ç½®ç©ºä½™ï¼Œ2 ä¸ª </em><br><em>ä½ç½®å­˜æ”¾äº† 2 ä¸ªå…ƒç´ ã€‚ </em><br>æ‰€ä»¥å¯èƒ½å³ä½¿ä½ æ•°æ®ä¸æ•°ç»„å®¹é‡ä¸€æ ·å¤§æ—¶ä¹Ÿä¸ä¸€å®šèƒ½æ­£æ­£å¥½å¥½çš„æŠŠæ•°ç»„å æ»¡çš„ï¼Œè€Œæ˜¯åœ¨æŸäº›å°æ ‡ä½ç½®å‡ºç°äº†å¤§é‡çš„ç¢°æ’ï¼Œåªèƒ½åœ¨åŒä¸€ä¸ªä½ç½®ç”¨é“¾è¡¨å­˜æ”¾ï¼Œé‚£ä¹ˆè¿™æ ·å°±å¤±å»äº† Map æ•°ç»„çš„æ€§èƒ½ã€‚<br>è¦é€‰æ‹©ä¸€ä¸ªåˆç†çš„å¤§å°ä¸‹è¿›è¡Œæ‰©å®¹ï¼Œé»˜è®¤å€¼ 0.75 å°±æ˜¯è¯´å½“é˜€å€¼å®¹é‡å äº† 3/4 æ—¶èµ¶ç´§æ‰©å®¹ï¼Œå‡å°‘ Hash ç¢°æ’ã€‚åŒæ—¶ 0.75 æ˜¯ä¸€ä¸ªé»˜è®¤æ„é€ å€¼ï¼Œåœ¨åˆ›å»º HashMap ä¹Ÿå¯ä»¥è°ƒæ•´ï¼Œæ¯”å¦‚ä½ å¸Œæœ›ç”¨æ›´å¤šçš„ç©ºé—´æ¢å–æ—¶é—´ï¼Œå¯ä»¥æŠŠè´Ÿè½½å› å­è°ƒçš„æ›´å°ä¸€äº›ï¼Œå‡å°‘ç¢°æ’ã€‚</p><h1 id="æ‰©å®¹å…ƒç´ æ‹†åˆ†"><a href="#æ‰©å®¹å…ƒç´ æ‹†åˆ†" class="headerlink" title="æ‰©å®¹å…ƒç´ æ‹†åˆ†"></a>æ‰©å®¹å…ƒç´ æ‹†åˆ†</h1><p>ä¸ºä»€ä¹ˆæ‰©å®¹ï¼Œå› ä¸ºæ•°ç»„é•¿åº¦ä¸è¶³äº†ã€‚é‚£æ‰©å®¹æœ€ç›´æ¥çš„é—®é¢˜ï¼Œå°±æ˜¯éœ€è¦æŠŠå…ƒç´ æ‹†åˆ†åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚æ‹†åˆ†å…ƒç´ çš„è¿‡ç¨‹ä¸­ï¼ŒåŸ jdk1.7 ä¸­ä¼šéœ€è¦é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œä½†æ˜¯åˆ° jdk1.8 ä¸­å·²ç»è¿›è¡Œä¼˜åŒ–ï¼Œä¸åœ¨éœ€è¦é‡æ–°è®¡ç®—ï¼Œæå‡äº†æ‹†åˆ†çš„æ€§èƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        list.add(<span class="string">&quot;one&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;power&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;technology&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;environment&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;good&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;sad&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;god&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;yeah&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;uncle&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;Java&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;PHP&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;C#&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;C&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;Python&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;GO&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String value : list) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">hash</span> <span class="operator">=</span> value.hashCode() ^ (value.hashCode() &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">key16</span> <span class="operator">=</span> hash &amp; (<span class="number">16</span> - <span class="number">1</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">key32</span> <span class="operator">=</span> hash &amp; (<span class="number">32</span> - <span class="number">1</span>);</span><br><span class="line">            System.out.println(</span><br><span class="line">                <span class="string">&quot;value:&quot;</span> + value +</span><br><span class="line">                <span class="string">&quot;\n\tkey(16):&quot;</span> + key16 +</span><br><span class="line">                <span class="string">&quot;\tBitå€¼:&quot;</span> + Integer.toBinaryString(hash) + <span class="string">&quot; - &quot;</span> + Integer.toBinaryString(hash &amp; <span class="number">16</span>) +</span><br><span class="line">                <span class="string">&quot;\n\tkey(32):&quot;</span> + key32 +</span><br><span class="line">                <span class="string">&quot;\tBitå€¼:&quot;</span> + Integer.toBinaryString(hash) + <span class="string">&quot; - &quot;</span> + Integer.toBinaryString(hash &amp; (<span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">value:one</span><br><span class="line">key(16):7Bitå€¼:11010111001100111 - 0</span><br><span class="line">key(32):7Bitå€¼:11010111001100111 - 111</span><br><span class="line">value:power</span><br><span class="line">key(16):11Bitå€¼:110010111101000111101011011 - 10000</span><br><span class="line">key(32):27Bitå€¼:110010111101000111101011011 - 11011</span><br><span class="line">value:technology</span><br><span class="line">key(16):11Bitå€¼:10011011111001110001111011101011 - 0</span><br><span class="line">key(32):11Bitå€¼:10011011111001110001111011101011 - 1011</span><br><span class="line">value:environment</span><br><span class="line">key(16):2Bitå€¼:11111010111000011100100011110010 - 10000</span><br><span class="line">key(32):18Bitå€¼:11111010111000011100100011110010 - 10010</span><br><span class="line">value:hello</span><br><span class="line">key(16):11Bitå€¼:101111010010001110100111011 - 10000</span><br><span class="line">key(32):27Bitå€¼:101111010010001110100111011 - 11011</span><br><span class="line">value:world</span><br><span class="line">key(16):3Bitå€¼:110110000010001110101010011 - 10000</span><br><span class="line">key(32):19Bitå€¼:110110000010001110101010011 - 10011</span><br><span class="line">value:good</span><br><span class="line">key(16):13Bitå€¼:1100001000000010001101 - 0</span><br><span class="line">key(32):13Bitå€¼:1100001000000010001101 - 1101</span><br><span class="line">value:sad</span><br><span class="line">key(16):7Bitå€¼:11011101111010111 - 10000</span><br><span class="line">key(32):23Bitå€¼:11011101111010111 - 10111</span><br><span class="line">value:god</span><br><span class="line">key(16):13Bitå€¼:11001000001111101 - 10000</span><br><span class="line">key(32):29Bitå€¼:11001000001111101 - 11101</span><br><span class="line">value:yeah</span><br><span class="line">key(16):11Bitå€¼:1110001000100000001011 - 0</span><br><span class="line">key(32):11Bitå€¼:1110001000100000001011 - 1011</span><br><span class="line">value:uncle</span><br><span class="line">key(16):7Bitå€¼:110101001000011100101000111 - 0</span><br><span class="line">key(32):7Bitå€¼:110101001000011100101000111 - 111</span><br><span class="line">value:Java</span><br><span class="line">key(16):1Bitå€¼:1000110001111001100001 - 0</span><br><span class="line">key(32):1Bitå€¼:1000110001111001100001 - 1</span><br><span class="line">value:PHP</span><br><span class="line">key(16):9Bitå€¼:10011010101011001 - 10000</span><br><span class="line">key(32):25Bitå€¼:10011010101011001 - 11001</span><br><span class="line">value:C#</span><br><span class="line">key(16):0Bitå€¼:100001000000 - 0</span><br><span class="line">key(32):0Bitå€¼:100001000000 - 0</span><br><span class="line">value:C</span><br><span class="line">key(16):3Bitå€¼:1000011 - 0</span><br><span class="line">key(32):3Bitå€¼:1000011 - 11</span><br><span class="line">value:Python</span><br><span class="line">key(16):15Bitå€¼:10001111011000111001001110011111 - 10000</span><br><span class="line">key(32):31Bitå€¼:10001111011000111001001110011111 - 11111</span><br><span class="line">value:GO</span><br><span class="line">key(16):8Bitå€¼:100011101000 - 0</span><br><span class="line">key(32):8Bitå€¼:100011101000 - 1000</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬éšæœºä½¿ç”¨ä¸€äº›å­—ç¬¦ä¸²è®¡ç®—ä»–ä»¬åˆ†åˆ«åœ¨ 16 ä½é•¿åº¦å’Œ 32 ä½é•¿åº¦æ•°ç»„ä¸‹çš„ç´¢å¼•åˆ†é…æƒ…å†µï¼Œçœ‹å“ªäº›æ•°æ®è¢«é‡æ–°è·¯ç”±åˆ°äº†æ–°çš„åœ°å€<br>åŒæ—¶ï¼Œè¿™é‡Œè¿˜å¯ä»¥è§‚å¯Ÿå‡ºä¸€ä¸ªéå¸¸é‡è¦çš„ä¿¡æ¯ï¼ŒåŸå“ˆå¸Œå€¼ä¸æ‰©å®¹æ–°å¢å‡ºæ¥çš„é•¿åº¦ 16ï¼Œè¿›è¡Œ&amp;è¿ç®—ï¼Œå¦‚æœå€¼ç­‰äº 0ï¼Œåˆ™ä¸‹æ ‡ä½ç½®ä¸å˜ã€‚å¦‚æœä¸ä¸º 0ï¼Œé‚£ä¹ˆæ–°çš„ä½ç½®åˆ™æ˜¯åŸæ¥ä½ç½®ä¸ŠåŠ  16ã€‚å¤šæ¬¡æµ‹è¯•å‘ç°è¿™é‡Œçš„16å¯ä»¥æ‰©å±•ä¸º 2 çš„næ¬¡æ–¹ã€‚å³ï¼š<br><strong>åŸå“ˆå¸Œå€¼ï¼ˆæ‰°åŠ¨å“ˆå¸Œï¼‰ä¸æ‰©å®¹æ–°å¢å‡ºæ¥çš„é•¿åº¦</strong> <strong>2 çš„ n æ¬¡æ–¹ï¼Œè¿›è¡Œ&amp;è¿ç®—</strong></p><ul><li><strong>å¦‚æœå€¼ç­‰äº 0ï¼Œåˆ™ä¸‹æ ‡ä½ç½®ä¸å˜ã€‚</strong></li><li><strong>å¦‚æœä¸ä¸º 0ï¼Œé‚£ä¹ˆæ–°çš„ä½ç½®åˆ™æ˜¯åŸæ¥ä½ç½®ä¸ŠåŠ  16</strong></li></ul><p><strong>ç”±æ­¤å¯è§,java 8 çš„æ•£åˆ—å€¼æ‰°åŠ¨å‡½æ•°ï¼Œåœ¨ä¼˜åŒ–æ•£åˆ—æ•ˆæœçš„åŒæ—¶ï¼Œä¹Ÿè®©æ‰©å®¹å…ƒç´ å˜å¾—æ›´åŠ çš„æ–¹ä¾¿ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> æˆ‘çš„å­¦ä¹ æ—¥è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SnowFlakeç®—æ³•</title>
      <link href="/posts/9a32a87d.html"/>
      <url>/posts/9a32a87d.html</url>
      
        <content type="html"><![CDATA[<p>snowflakeæ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œç»“æœæ˜¯ä¸€ä¸ªlongå‹çš„IDã€‚</p><p>å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä½¿ç”¨41bitä½œä¸ºæ¯«ç§’æ•°ï¼Œ10bitä½œä¸ºæœºå™¨çš„IDï¼ˆ5ä¸ªbitæ˜¯æ•°æ®ä¸­å¿ƒï¼Œ5ä¸ªbitçš„æœºå™¨IDï¼‰ï¼Œ12bitä½œä¸ºæ¯«ç§’å†…çš„æµæ°´å·ï¼ˆæ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹åœ¨æ¯æ¯«ç§’å¯ä»¥äº§ç”Ÿ 4096 ä¸ª IDï¼‰ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ªç¬¦å·ä½ï¼Œæ°¸è¿œæ˜¯0ã€‚</p><h2 id="å…·ä½“ä»‹ç»"><a href="#å…·ä½“ä»‹ç»" class="headerlink" title="å…·ä½“ä»‹ç»"></a>å…·ä½“ä»‹ç»</h2><p>é›ªèŠ±ç®—æ³•æ˜¯ 64 ä½ çš„äºŒè¿›åˆ¶ï¼Œä¸€å…±åŒ…å«äº†å››éƒ¨åˆ†ï¼š</p><ul><li>1ä½æ˜¯ç¬¦å·ä½ï¼Œä¹Ÿå°±æ˜¯æœ€é«˜ä½ï¼Œå§‹ç»ˆæ˜¯0ï¼Œæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºè¦æ˜¯å”¯ä¸€è®¡ç®—æœºäºŒè¿›åˆ¶è¡¥ç ä¸­å°±æ˜¯è´Ÿæ•°ï¼Œ0æ‰æ˜¯æ­£æ•°ã€‚</li><li>41ä½æ˜¯æ—¶é—´æˆ³ï¼Œå…·ä½“åˆ°æ¯«ç§’ï¼Œ41ä½çš„äºŒè¿›åˆ¶å¯ä»¥ä½¿ç”¨69å¹´ï¼Œå› ä¸ºæ—¶é—´ç†è®ºä¸Šæ°¸æ’é€’å¢ï¼Œæ‰€ä»¥æ ¹æ®è¿™ä¸ªæ’åºæ˜¯å¯ä»¥çš„ã€‚</li><li>10ä½æ˜¯æœºå™¨æ ‡è¯†ï¼Œå¯ä»¥å…¨éƒ¨ç”¨ä½œæœºå™¨IDï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ ‡è¯†æœºæˆ¿ID + æœºå™¨IDï¼Œ10ä½æœ€å¤šå¯ä»¥è¡¨ç¤º1024å°æœºå™¨ã€‚</li><li>12ä½æ˜¯è®¡æ•°åºåˆ—å·ï¼Œä¹Ÿå°±æ˜¯åŒä¸€å°æœºå™¨ä¸ŠåŒä¸€æ—¶é—´ï¼Œç†è®ºä¸Šè¿˜å¯ä»¥åŒæ—¶ç”Ÿæˆä¸åŒçš„IDï¼Œ12ä½çš„åºåˆ—å·èƒ½å¤ŸåŒºåˆ†å‡º4096ä¸ªIDã€‚</li></ul><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/snowflake.png" alt="snowflake"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.ray.domain.support.ids;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ray</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/12 16:18</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é›ªèŠ±ç®—æ³•ç”ŸæˆéšæœºID</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SnowFlake</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(SnowFlake.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒ(æœºæˆ¿)ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> dataCenterId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> workerId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒä¸€æ—¶é—´çš„åºåˆ—å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> sequence;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹æ—¶é—´æˆ³:2020-05-20 08:00:00 +0800 CST</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">twepoch</span> <span class="operator">=</span> <span class="number">1589923200000L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºæˆ¿IDæ‰€å ä½æ•° 5bit æœ€å¤§:11111(äºŒè¿›åˆ¶)--&gt;31(åè¿›åˆ¶)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">dataCenterIdBits</span> <span class="operator">=</span> <span class="number">5L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨IDæ‰€å ä½æ•° 5bit æœ€å¤§:11111(äºŒè¿›åˆ¶)--&gt;31(åè¿›åˆ¶)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">workerIdBits</span> <span class="operator">=</span> <span class="number">5L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒä¸€æ—¶é—´çš„åºåˆ—å·æ‰€å ä½æ•° 12bit æœ€å¤§:111111111111(äºŒè¿›åˆ¶)--&gt;4095(åè¿›åˆ¶)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">sequenceBits</span> <span class="operator">=</span> <span class="number">12L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 5 bitæœ€å¤šåªèƒ½æœ‰31ä¸ªæ•°å­—ï¼Œå³æœºæˆ¿idæ•°é‡æœ€å¤šåªèƒ½æ˜¯32ä»¥å†…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">maxDataCenterId</span> <span class="operator">=</span> -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; dataCenterIdBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 5 bitæœ€å¤šåªèƒ½æœ‰31ä¸ªæ•°å­—ï¼Œå³æœºå™¨idæ•°é‡æœ€å¤šåªèƒ½æ˜¯32ä»¥å†…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">maxWorkerId</span> <span class="operator">=</span> -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; workerIdBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·æ©ç (0b111111111111==&gt;0xfff==&gt;4096)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">sequenceMask</span> <span class="operator">=</span> -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; sequenceBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨IDåç§»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">workerIdShift</span> <span class="operator">=</span> sequenceBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºæˆ¿IDåç§»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">dataCenterIdShift</span> <span class="operator">=</span> workerIdBits + sequenceBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¶é—´æˆ³åç§»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">timestampLeftShift</span> <span class="operator">=</span> dataCenterIdBits + workerIdBits + sequenceBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€è¿‘ä¸€æ¬¡æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="variable">lastTimestamp</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SnowFlake</span><span class="params">(<span class="type">long</span> dataCenterId, <span class="type">long</span> workerId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(dataCenterId,workerId,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SnowFlake</span><span class="params">(<span class="type">long</span> dataCenterId, <span class="type">long</span> workerId, <span class="type">long</span> sequence)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( dataCenterId&gt;maxDataCenterId || dataCenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(String.format(<span class="string">&quot;æœºæˆ¿ID å¤§äºæœ€å¤§å€¼ %d æˆ–è€… å°äº 0&quot;</span>,maxDataCenterId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( workerId&gt;maxWorkerId || workerId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(String.format(<span class="string">&quot;æœºå™¨ID å¤§äºæœ€å¤§å€¼ %d æˆ–è€… å°äº 0&quot;</span>,maxWorkerId));</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(<span class="string">&quot;æœºå™¨å¯åŠ¨ä¸­: æ—¶é—´æˆ³åç§»é‡:&#123;&#125;,æœºæˆ¿IDå ä½:&#123;&#125;,æœºå™¨IDå ä½:&#123;&#125;,åºåˆ—å·å ä½:&#123;&#125;,æœºå™¨ID:&#123;&#125;&quot;</span>,</span><br><span class="line">                timestampLeftShift,dataCenterIdBits,workerIdBits,sequenceBits,workerId);</span><br><span class="line">        <span class="built_in">this</span>.dataCenterId = dataCenterId;</span><br><span class="line">        <span class="built_in">this</span>.workerId = workerId;</span><br><span class="line">        <span class="built_in">this</span>.sequence = sequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æœºæˆ¿ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æœºæˆ¿ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getDataCenterId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dataCenterId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æœºå™¨ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æœºå™¨ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getWorkerId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> workerId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æœ€æ–°çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¸Šä¸€æ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getLastTimestamp</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> lastTimestamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸‹ä¸€ä¸ªéšæœºID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> éšæœºID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">long</span> <span class="title function_">nextId</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTimestamp</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (currentTimestamp &lt; lastTimestamp) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;æ—¶é—´å›é€€,æœ€æ–°æ—¶é—´æˆ³:&#123;&#125;&quot;</span>,lastTimestamp);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(String.format(<span class="string">&quot;æ—¶é—´å›é€€,æ‹’ç»ç”ŸæˆID,å®é™…ç›¸å·®: %d&quot;</span>,lastTimestamp - currentTimestamp));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å»é‡</span></span><br><span class="line">        <span class="keyword">if</span> (currentTimestamp == lastTimestamp) &#123;</span><br><span class="line">            sequence = (sequenceMask+<span class="number">1</span>) &amp; sequenceMask;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœ sequence åºåˆ—å· å¤§äº 4095</span></span><br><span class="line">            <span class="keyword">if</span>(sequence == <span class="number">0</span>) &#123;</span><br><span class="line">                currentTimestamp = nextTimestamp(lastTimestamp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯å½“å‰æ—¶é—´ç¬¬ä¸€æ¬¡ç”ŸæˆID,å°±åˆå§‹åŒ–ä¸º0</span></span><br><span class="line">            sequence = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®°å½•æœ€æ–°æ—¶é—´æˆ³</span></span><br><span class="line">        lastTimestamp = currentTimestamp;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åç§»è®¡ç®—ç”ŸæˆéšæœºID</span></span><br><span class="line">        <span class="keyword">return</span> ((currentTimestamp - twepoch) &lt;&lt; timestampLeftShift) |</span><br><span class="line">                (dataCenterId &lt;&lt; dataCenterIdShift) |</span><br><span class="line">                (workerId &lt;&lt; workerIdShift) |</span><br><span class="line">                sequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="title function_">nextTimestamp</span><span class="params">(<span class="type">long</span> lastTimestamp)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTimestamp</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰æ—¶é—´æˆ³å°äºç­‰äº åºåˆ—å·å·²ç»è¶…è¿‡4095 é‚£ä¸ªæ—¶é—´æˆ³</span></span><br><span class="line">        <span class="comment">// ç»§ç»­è·å–æœ€æ–°æ—¶é—´æˆ³</span></span><br><span class="line">        <span class="keyword">if</span> (currentTimestamp &lt;= lastTimestamp) &#123;</span><br><span class="line">            currentTimestamp = System.currentTimeMillis();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> currentTimestamp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-1314261683.cos.ap-chongqing.myqcloud.com/image/snowflake_shift.png" alt="snowflake_shift"></p><ul><li>æœ€åå°†ä¸‰éƒ¨åˆ†(æ—¶é—´æˆ³ã€æœºå™¨IDã€åºåˆ—å·)æŒ‰ç…§åç§»é‡è¿›è¡Œç§»ä½æ“ä½œï¼Œç„¶åæŒ‰ä½æˆ–å°†å…¶ç»„åˆå³å¯å¾—åˆ°éšæœºç”Ÿæˆçš„å”¯ä¸€ID</li></ul><h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><ul><li><p>ç”±äº41ä½æ˜¯æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬çš„æ—¶é—´è®¡ç®—æ˜¯ä»1970å¹´å¼€å§‹çš„ï¼Œåªèƒ½ä½¿ç”¨69å¹´ï¼Œä¸ºäº†ä¸æµªè´¹ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ç”¨æ—¶é—´çš„ç›¸å¯¹å€¼ï¼Œä¹Ÿå°±æ˜¯ä»¥é¡¹ç›®å¼€å§‹çš„æ—¶é—´ä¸ºåŸºå‡†æ—¶é—´ï¼Œå¾€åå¯ä»¥ä½¿ç”¨69å¹´ã€‚è·å–å”¯ä¸€IDçš„æœåŠ¡ï¼Œå¯¹å¤„ç†é€Ÿåº¦è¦æ±‚æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¨éƒ¨ä½¿ç”¨ä½è¿ç®—ä»¥åŠä½ç§»æ“ä½œï¼Œè·å–å½“å‰æ—¶é—´å¯ä»¥ä½¿ç”¨<code>System.currentTimeMillis()</code>ã€‚</p></li><li><h3 id="æ—¶é—´å›æ‹¨é—®é¢˜"><a href="#æ—¶é—´å›æ‹¨é—®é¢˜" class="headerlink" title="æ—¶é—´å›æ‹¨é—®é¢˜"></a>æ—¶é—´å›æ‹¨é—®é¢˜</h3><p>åœ¨è·å–æ—¶é—´çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°<code>æ—¶é—´å›æ‹¨</code>çš„é—®é¢˜ï¼Œæ—¶é—´å›æ‹¨å…¶å®å°±æ˜¯æœåŠ¡å™¨ä¸Šçš„æ—¶é—´çªç„¶å€’é€€åˆ°ä¹‹å‰çš„æ—¶é—´ã€‚</p><ol><li>äººä¸ºåŸå› ï¼ŒæŠŠç³»ç»Ÿç¯å¢ƒçš„æ—¶é—´æ”¹äº†ã€‚</li><li>æœ‰æ—¶å€™ä¸åŒçš„æœºå™¨ä¸Šéœ€è¦åŒæ­¥æ—¶é—´ï¼Œå¯èƒ½ä¸åŒæœºå™¨ä¹‹é—´å­˜åœ¨è¯¯å·®ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°æ—¶é—´å›æ‹¨é—®é¢˜ã€‚</li></ol><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><ol><li>å›æ‹¨æ—¶é—´å°çš„æ—¶å€™ï¼Œä¸ç”Ÿæˆ IDï¼Œå¾ªç¯ç­‰å¾…åˆ°æ—¶é—´ç‚¹åˆ°è¾¾ã€‚</li><li>ä¸Šé¢çš„æ–¹æ¡ˆåªé€‚åˆæ—¶é’Ÿå›æ‹¨è¾ƒå°çš„ï¼Œå¦‚æœé—´éš”è¿‡å¤§ï¼Œé˜»å¡ç­‰å¾…ï¼Œè‚¯å®šæ˜¯ä¸å¯å–çš„ï¼Œå› æ­¤è¦ä¹ˆè¶…è¿‡ä¸€å®šå¤§å°çš„å›æ‹¨ç›´æ¥æŠ¥é”™ï¼Œæ‹’ç»æœåŠ¡ï¼Œæˆ–è€…æœ‰ä¸€ç§æ–¹æ¡ˆæ˜¯åˆ©ç”¨æ‹“å±•ä½ï¼Œå›æ‹¨ä¹‹ååœ¨æ‹“å±•ä½ä¸ŠåŠ 1å°±å¯ä»¥äº†ï¼Œè¿™æ ·IDä¾ç„¶å¯ä»¥ä¿æŒå”¯ä¸€ã€‚ä½†æ˜¯è¿™ä¸ªè¦æ±‚æˆ‘ä»¬æå‰é¢„ç•™å‡ºä½æ•°ï¼Œè¦ä¹ˆä»æœºå™¨idä¸­ï¼Œè¦ä¹ˆä»åºåˆ—å·ä¸­ï¼Œè…¾å‡ºä¸€å®šçš„ä½ï¼Œåœ¨æ—¶é—´å›æ‹¨çš„æ—¶å€™ï¼Œè¿™ä¸ªä½ç½® <code>+1</code>ã€‚</li></ol></li></ul><h2 id="ç›¸å…³é—®é¢˜"><a href="#ç›¸å…³é—®é¢˜" class="headerlink" title="ç›¸å…³é—®é¢˜"></a>ç›¸å…³é—®é¢˜</h2><h3 id="1-ç¬¬ä¸€ä½ä¸ºä»€ä¹ˆä¸ä½¿ç”¨"><a href="#1-ç¬¬ä¸€ä½ä¸ºä»€ä¹ˆä¸ä½¿ç”¨" class="headerlink" title="1. ç¬¬ä¸€ä½ä¸ºä»€ä¹ˆä¸ä½¿ç”¨?"></a>1. ç¬¬ä¸€ä½ä¸ºä»€ä¹ˆä¸ä½¿ç”¨?</h3><p>åœ¨è®¡ç®—æœºçš„è¡¨ç¤ºä¸­ï¼Œç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ï¼Œ0è¡¨ç¤ºæ•´æ•°ï¼Œç¬¬ä¸€ä½å¦‚æœæ˜¯1åˆ™è¡¨ç¤ºè´Ÿæ•°ï¼Œæˆ‘ä»¬ç”¨çš„IDé»˜è®¤å°±æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥é»˜è®¤å°±æ˜¯0ï¼Œé‚£ä¹ˆè¿™ä¸€ä½é»˜è®¤å°±æ²¡æœ‰æ„ä¹‰ã€‚</p><h3 id="2-æœºå™¨ä½æ€ä¹ˆç”¨ï¼Ÿ"><a href="#2-æœºå™¨ä½æ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="2.æœºå™¨ä½æ€ä¹ˆç”¨ï¼Ÿ"></a>2.æœºå™¨ä½æ€ä¹ˆç”¨ï¼Ÿ</h3><p>æœºå™¨ä½æˆ–è€…æœºæˆ¿ä½ï¼Œä¸€å…±10 bitï¼Œå¦‚æœå…¨éƒ¨è¡¨ç¤ºæœºå™¨ï¼Œé‚£ä¹ˆå¯ä»¥è¡¨ç¤º1024å°æœºå™¨ï¼Œå¦‚æœæ‹†åˆ†ï¼Œ5 bit è¡¨ç¤ºæœºæˆ¿ï¼Œ5bitè¡¨ç¤ºæœºæˆ¿é‡Œé¢çš„æœºå™¨ï¼Œé‚£ä¹ˆå¯ä»¥æœ‰32ä¸ªæœºæˆ¿ï¼Œæ¯ä¸ªæœºæˆ¿å¯ä»¥ç”¨32å°æœºå™¨ã€‚</p><h3 id="3-twepochè¡¨ç¤ºä»€ä¹ˆï¼Ÿ"><a href="#3-twepochè¡¨ç¤ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. twepochè¡¨ç¤ºä»€ä¹ˆï¼Ÿ"></a>3. twepochè¡¨ç¤ºä»€ä¹ˆï¼Ÿ</h3><p>ç”±äºæ—¶é—´æˆ³åªèƒ½ç”¨69å¹´ï¼Œæˆ‘ä»¬çš„è®¡æ—¶åˆæ˜¯ä»1970å¹´å¼€å§‹çš„ï¼Œæ‰€ä»¥è¿™ä¸ª<code>twepoch</code>è¡¨ç¤ºä»é¡¹ç›®å¼€å§‹çš„æ—¶é—´ï¼Œç”¨ç”ŸæˆIDçš„æ—¶é—´å‡å»<code>twepoch</code>ä½œä¸ºæ—¶é—´æˆ³ï¼Œå¯ä»¥ä½¿ç”¨æ›´ä¹…ã€‚</p><h3 id="4-1L-1L-lt-lt-x-è¡¨ç¤ºä»€ä¹ˆï¼Ÿ"><a href="#4-1L-1L-lt-lt-x-è¡¨ç¤ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. -1L ^ (-1L &lt;&lt; x) è¡¨ç¤ºä»€ä¹ˆï¼Ÿ"></a>4. -1L ^ (-1L &lt;&lt; x) è¡¨ç¤ºä»€ä¹ˆï¼Ÿ</h3><p>è¡¨ç¤º x ä½äºŒè¿›åˆ¶å¯ä»¥è¡¨ç¤ºå¤šå°‘ä¸ªæ•°å€¼ï¼Œå‡è®¾xä¸º3ï¼š</p><p>åœ¨è®¡ç®—æœºä¸­ï¼Œç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ï¼Œè´Ÿæ•°çš„åç æ˜¯é™¤äº†ç¬¦å·ä½ï¼Œ1å˜0ï¼Œ0å˜1, è€Œè¡¥ç åˆ™æ˜¯åç +1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1L åŸç ï¼š1000 0001</span><br><span class="line">-1L åç ï¼š1111 1110</span><br><span class="line">-1L è¡¥ç ï¼š1111 1111</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ç»“æœå¯ä»¥çŸ¥é“ï¼Œ<strong>-1Lå…¶å®åœ¨äºŒè¿›åˆ¶é‡Œé¢å…¶å®å°±æ˜¯å…¨éƒ¨ä¸º1</strong>,é‚£ä¹ˆ -1L å·¦ç§»åŠ¨ 3ä½ï¼Œå…¶å®å¾—åˆ° <code>1111 1000</code>ï¼Œä¹Ÿå°±æ˜¯æœ€å3ä½æ˜¯0ï¼Œå†ä¸<code>-1L</code>å¼‚æˆ–è®¡ç®—ä¹‹åï¼Œå…¶å®å¾—åˆ°çš„ï¼Œå°±æ˜¯åé¢3ä½å…¨æ˜¯1ã€‚</p><p><code>-1L ^ (-1L &lt;&lt; x)</code>è¡¨ç¤ºçš„å…¶å®å°±æ˜¯xä½å…¨æ˜¯1çš„å€¼ï¼Œä¹Ÿå°±æ˜¯xä½çš„äºŒè¿›åˆ¶èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼ã€‚</p><h3 id="5-æ—¶é—´æˆ³æ¯”è¾ƒ"><a href="#5-æ—¶é—´æˆ³æ¯”è¾ƒ" class="headerlink" title="5.æ—¶é—´æˆ³æ¯”è¾ƒ"></a>5.æ—¶é—´æˆ³æ¯”è¾ƒ</h3><p>åœ¨è·å–æ—¶é—´æˆ³å°äºä¸Šä¸€æ¬¡è·å–çš„æ—¶é—´æˆ³çš„æ—¶å€™ï¼Œä¸èƒ½ç”ŸæˆIDï¼Œè€Œæ˜¯ç»§ç»­å¾ªç¯ï¼Œç›´åˆ°ç”Ÿæˆå¯ç”¨çš„IDï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨æ‹“å±•ä½é˜²æ­¢æ—¶é’Ÿå›æ‹¨ã€‚</p><h3 id="6-å‰ç«¯ç›´æ¥ä½¿ç”¨å‘ç”Ÿç²¾åº¦ä¸¢å¤±"><a href="#6-å‰ç«¯ç›´æ¥ä½¿ç”¨å‘ç”Ÿç²¾åº¦ä¸¢å¤±" class="headerlink" title="6.å‰ç«¯ç›´æ¥ä½¿ç”¨å‘ç”Ÿç²¾åº¦ä¸¢å¤±"></a>6.å‰ç«¯ç›´æ¥ä½¿ç”¨å‘ç”Ÿç²¾åº¦ä¸¢å¤±</h3><p>å¦‚æœå‰ç«¯ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯ç”Ÿæˆçš„ long ç±»å‹ idï¼Œä¼šå‘ç”Ÿç²¾åº¦ä¸¢å¤±çš„é—®é¢˜ï¼Œå› ä¸º JS ä¸­Numberæ˜¯16ä½çš„ï¼ˆæŒ‡çš„æ˜¯åè¿›åˆ¶çš„æ•°å­—ï¼‰ï¼Œè€Œé›ªèŠ±ç®—æ³•è®¡ç®—å‡ºæ¥æœ€é•¿çš„æ•°å­—æ˜¯19ä½çš„ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨ String ä½œä¸ºä¸­é—´è½¬æ¢ï¼Œè¾“å‡ºåˆ°å‰ç«¯å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Test</title>
      <link href="/posts/784dd132.html"/>
      <url>/posts/784dd132.html</url>
      
        <content type="html"><![CDATA[<p>this is Test</p><div class="table-container"><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/L-XRay"><img src="https://github-readme-stats.vercel.app/api/?username=L-XRay&theme=calm&show_owner=true"/></a></td></tr></tbody></table></div><div class="video"><video controls preload><source src='https://www.bilibili.com/bangumi/play/ep64315?from_spmid=666.4.feed.12' type='video/mp4'>Your browser does not support the video tag.</video></div>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
